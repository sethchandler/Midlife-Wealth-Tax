<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Effect Visualization</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .controls label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }
        
        .controls input[type="range"] {
            flex: 1;
            margin: 0 10px;
        }
        
        .controls select {
            padding: 5px;
            font-size: 14px;
        }
        
        #chartContainer {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            width: 100%;
            box-sizing: border-box;
        }
        
        #chartContainer canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }
        
        #tableContainer {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        #tableContainer table {
            width: 100%;
            border-collapse: collapse;
        }
        
        #tableContainer td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        
        p {
            text-align: center;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="controls">
        <label>Interest rate: <input type="range" id="r" min="0.01" max="0.09" step="0.01" value="0.06"><span id="r-val">0.06</span></label>
        <label>Impatience rate: <input type="range" id="rho" min="0.02" max="0.09" step="0.01" value="0.04"><span id="rho-val">0.04</span></label>
        <label>Consumption risk aversion: <input type="range" id="gamma" min="0.3" max="2.5" step="0.2" value="0.7"><span id="gamma-val">0.7</span></label>
        <label>Bequest risk aversion: <input type="range" id="eta" min="0.3" max="2.5" step="0.2" value="1.7"><span id="eta-val">1.7</span></label>
        <label>Bequest importance: <input type="range" id="beta" min="0" max="15" step="0.1" value="3"><span id="beta-val">3</span></label>
        <label>Tax rate: <input type="range" id="tau" min="0" max="0.5" step="0.01" value="0"><span id="tau-val">0</span></label>
        <label>Years before tax: <input type="range" id="t1" min="10" max="30" step="1" value="20"><span id="t1-val">20</span></label>
        <label>Years after tax: <input type="range" id="t2" min="10" max="30" step="1" value="25"><span id="t2-val">25</span></label>
        <label style="grid-column: 1 / -1;">Visualize: 
            <select id="visualize">
                <option value="Wealth Trajectory">Wealth Trajectory</option>
                <option value="Consumption Trajectory">Consumption Trajectory</option>
                <option value="Tax Effect Curves">Tax Effect Curves</option>
            </select>
        </label>
    </div>
    
    <div id="chartContainer">
        <canvas id="myChart"></canvas>
    </div>
    
    <div id="tableContainer"></div>
    
    <p>Created by Seth J. Chandler for educational use only</p>
    
    <!-- Load dependencies in correct order -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <script>
        // Register the annotation plugin properly for the current Chart.js version
        if (typeof Chart !== 'undefined' && Chart.register) {
            // Try different possible names for the annotation plugin
            if (typeof annotationPlugin !== 'undefined') {
                Chart.register(annotationPlugin);
            } else if (typeof ChartAnnotation !== 'undefined') {
                Chart.register(ChartAnnotation);
            } else if (window['chartjs-plugin-annotation']) {
                Chart.register(window['chartjs-plugin-annotation']);
            }
        }
    </script>
    <script src="main.js"></script>
    <script src="ui.js"></script>
</body>
</html>
